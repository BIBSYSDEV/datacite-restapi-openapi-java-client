plugins {
    id "org.openapi.generator" version "4.3.0"
    id "java-library"
}

task prepareDirs {
    mustRunAfter clean
    doLast {
        mkdir "$buildDir/generated"
    }
}

task buildDataciteRestApiClient(type: org.openapitools.generator.gradle.plugin.tasks.GenerateTask) {

    generatorName = "java"
    inputSpec = "$rootDir/datacite_openapi.yaml".toString()
    outputDir = "$buildDir/generated".toString()
    apiPackage = "no.unit.nva.doi.datacite.client.api"
    invokerPackage = "no.unit.nva.doi.datacite.client.invoker"
    modelPackage = "no.unit.nva.doi.datacite.client.model"

    generateModelTests = false
    generateApiTests = false
    library = "native"
    groupId = "no.unit.openapi.datacite.restapi"


    configOptions = [
        dateLibrary: "java8",
        java8: "true",
        hideGenerationTimestamp: "true",

        artifactId: "library-native-client",

       // developerName: "UNIT developers",
        gitHost: "git@github.com:BIBSYSDEV/datacite-restapi-openapi-java-client.git",
        gitUserId: "BIBSYSDEV",
        gitRepoId: "datacite-restapi-openapi-java-client"


    ]
}

compileJava.dependsOn buildDataciteRestApiClient
